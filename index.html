<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Painel Dengue v2</title>
  <meta name="theme-color" content="#0b4aa2"/>
  <link rel="preconnect" href="https://unpkg.com"/>
  <link rel="preconnect" href="https://cdn.jsdelivr.net"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <link rel="stylesheet" href="assets/style.css"/>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">ü¶ü</div>
      <div>
        <div class="title">painel-dengue.v2</div>
        <div class="subtitle">Mapa + s√©ries temporais (SINAN) ‚Ä¢ r√°pido, limpo e objetivo</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="btnAbout" class="btn ghost">Sobre</button>
      <button id="btnReset" class="btn">Reset</button>
    </div>
  </header>

  <main class="layout">
    <aside class="panel">
      <div class="section">
        <div class="section-title">Mapa</div>

        <label class="lbl">N√≠vel</label>
        <div class="segmented" role="tablist" aria-label="N√≠vel do mapa">
          <button class="seg on" id="levelUF" aria-selected="true">Estados</button>
          <button class="seg" id="levelMUN" aria-selected="false">Munic√≠pios (por UF)</button>
        </div>

        <label class="lbl">Ano</label>
        <select id="yearSel" class="select"></select>

        <label class="lbl">UF</label>
        <select id="ufSel" class="select" disabled></select>

        <div class="hint">
          Dica: no modo Munic√≠pios, selecione uma UF. O mapa carrega o GeoJSON do estado escolhido.
        </div>
      </div>

      <div class="section">
        <div class="section-title">S√©ries temporais</div>

        <label class="lbl">Vis√£o</label>
        <select id="seriesSel" class="select">
          <option value="total">Total Brasil</option>
          <option value="sexo">Sexo</option>
          <option value="raca">Ra√ßa/cor</option>
          <option value="escolaridade">Escolaridade</option>
        </select>

        <label class="lbl">Filtro (categoria)</label>
        <select id="catSel" class="select"></select>

        <div class="hint">
          O gr√°fico mostra casos prov√°veis por ano. Para mapas, usamos UF/Munic√≠pio por ano.
        </div>
      </div>

      <div class="section">
        <div class="section-title">Sazonalidade (m√™s)</div>
        <label class="lbl">Faixa et√°ria</label>
        <select id="ageSel" class="select"></select>

        <div class="hint">
          Este bloco usa o arquivo ‚Äúfaixa et√°ria‚Äù em formato mensal (agregado). Se voc√™ tiver a vers√£o por ano, d√° pra
          transformar em s√©rie temporal tamb√©m.
        </div>
      </div>

      <div class="section mini">
        <div class="kpis">
          <div class="kpi">
            <div class="kpi-label">Ano</div>
            <div class="kpi-val" id="kpiYear">‚Äî</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Selecionado</div>
            <div class="kpi-val" id="kpiPlace">Brasil</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Casos</div>
            <div class="kpi-val" id="kpiCases">‚Äî</div>
          </div>
        </div>
        <div class="smallprint">
          Fonte: Minist√©rio da Sa√∫de/SVSA ‚Äì SINAN (exportado). Veja os arquivos em <code>/data</code>.
        </div>
      </div>
    </aside>

    <section class="content">
      <div class="grid">
        <div class="card mapcard">
          <div class="card-head">
            <div>
              <div class="card-title">Mapa (Leaflet)</div>
              <div class="card-sub" id="mapSub">Estados ‚Ä¢ casos prov√°veis no ano selecionado</div>
            </div>
            <div class="chip" id="mapChip">Pronto</div>
          </div>
          <div id="map" class="map"></div>
          <div class="legend" id="legend"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div>
              <div class="card-title">S√©rie temporal</div>
              <div class="card-sub" id="seriesSub">Brasil ‚Ä¢ casos por ano</div>
            </div>
            <div class="chip" id="seriesChip">‚Äî</div>
          </div>
          <div class="chartWrap">
            <canvas id="chartSeries" height="140"></canvas>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Sazonalidade (m√™s)</div>
              <div class="card-sub" id="seasonSub">Faixa et√°ria selecionada</div>
            </div>
            <div class="chip" id="seasonChip">‚Äî</div>
          </div>
          <div class="chartWrap">
            <canvas id="chartSeason" height="140"></canvas>
          </div>
        </div>

        <div class="card insights">
          <div class="card-head">
            <div>
              <div class="card-title">Texto autom√°tico</div>
              <div class="card-sub">Para policy makers: curto e direto</div>
            </div>
            <div class="chip" id="insightsChip">‚Äî</div>
          </div>
          <div id="insights" class="insightsBody">
            <div class="muted">Selecione um ano e clique em um estado/munic√≠pio no mapa para gerar o resumo.</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <dialog id="aboutDlg" class="dlg">
    <div class="dlgHead">
      <div class="dlgTitle">Sobre o painel</div>
      <button id="btnCloseAbout" class="btn ghost">Fechar</button>
    </div>
    <div class="dlgBody">
      <p>
        Este painel foi feito para ser <b>leve</b> e <b>did√°tico</b>:
        mapa (Leaflet) + gr√°ficos (Chart.js) + leitura direta dos CSVs.
      </p>
      <ul>
        <li>Mapa de <b>UF</b> (Brasil) ou <b>Munic√≠pios</b> por UF (carregamento sob demanda).</li>
        <li>S√©ries temporais: total Brasil, sexo, ra√ßa/cor e escolaridade.</li>
        <li>Sazonalidade mensal por faixa et√°ria (arquivo agregado).</li>
      </ul>
      <p class="muted">
        GeoJSON: estados (geodata-br-states) e munic√≠pios por UF (geodata-br). Voc√™ pode trocar as URLs no <code>assets/app.js</code>.
      </p>
    </div>
  </dialog>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="assets/app.js"></script>
</body>
</html>
